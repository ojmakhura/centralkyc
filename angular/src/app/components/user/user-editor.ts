// Generated by andromda-angular cartridge (view\components\component.ts.vsl) DO NOT EDIT
import {
  AfterViewInit,
  Component,
  inject,
  Input,
  OnInit,
  ViewChild,
  signal,
  Signal,
  OnDestroy,
  linkedSignal,
} from "@angular/core";
import {COMMA, ENTER} from '@angular/cdk/keycodes';
import {
  FormsModule,
  ReactiveFormsModule,
  FormGroup,
  FormControl,
  Validators,
  FormArray,
} from "@angular/forms";
import { SelectItem } from "@app/utils/select-item";
import { 
    form,
    required,
    email,
    min,
    minLength, 
    max,
    maxLength,
} from "@angular/forms/signals";
import { TableComponent } from '@components/table/table';
import { ColumnModel } from "@models/column.model";
import { ActionTemplate } from '@models/action-template';
import { MatSelectChange } from '@angular/material/select';
import { MatRadioChange } from '@angular/material/radio';
import { MatCheckboxChange } from '@angular/material/checkbox';
import { MatChip, MatChipInput, MatChipInputEvent } from "@angular/material/chips";
import {MatAutocompleteSelectedEvent, MatAutocompleteModule} from '@angular/material/autocomplete';
import { MatDialog } from '@angular/material/dialog';
import { firstValueFrom, Observable, map, of, startWith, Subscription } from "rxjs";
import { CommonModule } from '@angular/common';
import { TranslateModule } from '@ngx-translate/core';
import { MaterialModule } from '@app/material.module';
import { OrganisationListDTO } from '@models/bw/co/centralkyc/organisation/organisation-list-dto';
import { GeneralStatus } from '@models/bw/co/centralkyc/general-status';
import { BranchDTO } from '@models/bw/co/centralkyc/organisation/branch/branch-dto';
import { SearchObject } from '@models/search-object';
import { GenericComponent } from "@views/generic.component";

export class UserEditorForm {
    userId: string | any = null;
    username: string | any = null;
    email: string | any = null;
    password: string | any = null;
    firstName: string | any = null;
    lastName: string | any = null;
    enabled: boolean | any = null;
    roles: Array<string> | any = null;
    organisation: OrganisationListDTO | any = null;
    organisationFilter: OrganisationListDTO | any = null;
    branch: BranchDTO | any = null;
    branchFilter: BranchDTO | any = null;

}

@Component({
  selector: "app-user-editor-base",
  template: "",
})
export abstract class UserEditorComponent extends GenericComponent<UserEditorForm> implements OnInit, OnDestroy, AfterViewInit {

    separatorKeysCodes: number[] = [ENTER, COMMA];
    @Input() userEditorForm: UserEditorForm = new UserEditorForm();
    userEditorComponentSignal = signal(this.userEditorForm);
    userEditorComponentSignalForm = form(this.userEditorComponentSignal, (path) => {
      required(path.username)
      required(path.email)
      email(path.email)
      required(path.password)
      required(path.firstName)
      required(path.lastName)
      required(path.enabled)
    });


    rolesAdd() {

    }

    rolesRemove(i: number, selected: any) {

    }
    organisationFilterCtrl: FormControl = new FormControl();

    organisationCompare(o1: OrganisationListDTO | any, o2: OrganisationListDTO | any) {
        return false;
    }

    filterOrganisation() {}

    organisationBackingList: OrganisationListDTO[] = [];
    organisationFilteredList = linkedSignal<OrganisationListDTO[]>(() => []);
    organisationChipControl: FormControl = new FormControl([]);

    organisationDisplays: string[] = [
        'name',
    ];
    branchFilterCtrl: FormControl = new FormControl();

    branchCompare(o1: BranchDTO | any, o2: BranchDTO | any) {
        return false;
    }

    filterBranch() {}

    branchBackingList: BranchDTO[] = [];
    branchFilteredList = linkedSignal<BranchDTO[]>(() => []);
    branchChipControl: FormControl = new FormControl([]);

    branchDisplays: string[] = [
        'name',
    ];
    GeneralStatusT: any = GeneralStatus;
    GeneralStatusOptions = Object.keys(this.GeneralStatusT);

    constructor(
    ) {
        super();
    }

    ngOnInit() {
        //if(!this.formGroupControl) {
        //    this.initForm();
        //}

        // this.formObject = this.userEditorComponentSignalForm;
    }

    ngOnDestroy() {}

    ngAfterViewInit() {

    }

    initForm() {
//        this.formGroupControl = this.formBuilder.group({
////            userId: [{value: this.userEditorForm.userId, disabled: false}],
////            username: [{value: this.userEditorForm.username, disabled: false}, [Validators.required, ]],
////            email: [{value: this.userEditorForm.email, disabled: false}, [Validators.required, Validators.email, ]],
////            password: [{value: this.userEditorForm.password, disabled: false}, [Validators.required, ]],
////            firstName: [{value: this.userEditorForm.firstName, disabled: false}, [Validators.required, ]],
////            lastName: [{value: this.userEditorForm.lastName, disabled: false}, [Validators.required, ]],
////            enabled: [{value: this.userEditorForm.enabled, disabled: false}, [Validators.required, ]],
//////            roles: this.formBuilder.array(this.userEditorForm.roles ? this.userEditorForm.roles : []),
//            roles: [{ value: this.userEditorForm.roles || [], disabled: false }],
////            organisation: [{value: this.userEditorForm.organisation, disabled: false}],
////            branch: [{value: this.userEditorForm.branch, disabled: false}],
//        });
    }



    //createOrganisationListDTOGroup(value?: OrganisationListDTO): FormGroup { 
    //    return this.formBuilder.group({
    //        id: [value?.id],
    //        code: [value?.code],
    //        name: [value?.name],
    //        registrationNo: [value?.registrationNo],
    //        status: [value?.status],
    //        contactEmailAddress: [value?.contactEmailAddress],
    //    });
    //}

    //createOrganisationListDTOArray(values?: OrganisationListDTO[]): FormArray {
    //    if(values) {
    //        let formArray: FormArray = this.formBuilder.array([]);
    //        values?.forEach(value => formArray.push(this.createOrganisationListDTOGroup(value)))

    //        return formArray;
    //    } else {
    //        return new FormArray([] as any);
    //    }
    //}



    //createBranchDTOGroup(value?: BranchDTO): FormGroup { 
    //    return this.formBuilder.group({
    //        id: [value?.id],
    //        createdBy: [value?.createdBy],
    //        createdAt: [value?.createdAt],
    //        modifiedBy: [value?.modifiedBy],
    //        modifiedAt: [value?.modifiedAt],
    //        code: [value?.code],
    //        name: [value?.name],
    //        description: [value?.description],
    //        physicalAddress: [value?.physicalAddress],
    //        organisationId: [value?.organisationId],
    //        organisation: [value?.organisation],
    //    });
    //}

    //createBranchDTOArray(values?: BranchDTO[]): FormArray {
    //    if(values) {
    //        let formArray: FormArray = this.formBuilder.array([]);
    //        values?.forEach(value => formArray.push(this.createBranchDTOGroup(value)))

    //        return formArray;
    //    } else {
    //        return new FormArray([] as any);
    //    }
    //}


    //get userIdControl(): FormControl {
    //    return this.formGroupControl?.get('userId') as FormControl;
   // }

    //get usernameControl(): FormControl {
    //    return this.formGroupControl?.get('username') as FormControl;
   // }

    //get emailControl(): FormControl {
    //    return this.formGroupControl?.get('email') as FormControl;
   // }

    //get passwordControl(): FormControl {
    //    return this.formGroupControl?.get('password') as FormControl;
   // }

    //get firstNameControl(): FormControl {
    //    return this.formGroupControl?.get('firstName') as FormControl;
   // }

    //get lastNameControl(): FormControl {
    //    return this.formGroupControl?.get('lastName') as FormControl;
   // }

    //get enabledControl(): FormControl {
    //    return this.formGroupControl?.get('enabled') as FormControl;
   // }

    //get rolesControl(): FormControl {
    //    return this.formGroupControl?.get('roles') as FormControl;
   // }

    //setRolesControl() {
    //    let t: any[] = [];
    //    this.userEditorForm.roles?.forEach((role: any) => {
    //        t.push(role.value);
    //    });
    //    this.rolesControl.setValue(t);
    // }
   
    rolesSelected(event: MatAutocompleteSelectedEvent): void {
     //   let item: Array<string> = event.option.value;

    //    this.userEditorForm.roles?.push(event.option.value);
    //    this.setRolesControl();
    //    this.rolesChipControl.setValue(null);

        // remove the selected rorolesle from the list
        // this.rolesBackingList = this.rolesBackingList.filter((roles: any) => roles.value !== item.value);
    //    this.rolesFilteredList$ = of(this.rolesBackingList);
    }

    private _rolesFilter(value: string): Array<string> {
        // if (!value) {
        //     return this.rolesBackingList;
        // }
        // const filterValue = value.toLowerCase();
    
        // return this.rolesBackingList.filter((item: any) => item.label.toLowerCase().includes(filterValue));

        return [];
    }

    //get organisationControl(): FormControl {
    //    return this.formGroupControl?.get('organisation') as FormControl;
   // }

    organisationAddDialog(){}

    organisationClear(){}

    organisationSelected(event: MatCheckboxChange, row: number){}

    organisationSearch(){}

    addSelectedOrganisation(){}

    //get branchControl(): FormControl {
    //    return this.formGroupControl?.get('branch') as FormControl;
   // }

    branchAddDialog(){}

    branchClear(){}

    branchSelected(event: MatCheckboxChange, row: number){}

    branchSearch(){}

    addSelectedBranch(){}

}